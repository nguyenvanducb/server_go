<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bitcoin Chart Realtime</title>
<script src="https://unpkg.com/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.development.js"></script>
<style>
#chart {
width: 100%;
height: 500px;
}
#tooltip {
position: absolute;
display: none;
background-color: white;
border: 1px solid black;
padding: 5px;
font-size: 12px;
pointer-events: none;
}
</style>
</head>
<body>
<select id="timeframe">
<option value="1d">1 Day</option>
<option value="4h">4 Hours</option>
<option value="1h">1 Hour</option>
<option value="30m">30 Minutes</option>
<option value="15m">15 Minutes</option>
<option value="5m">5 Minutes</option>
<option value="1m">1 Minute</option>
</select>
<select id="indicator">
<option value="none">Select Indicator</option>
<option value="rsi">RSI</option>
<option value="macd">MACD</option>
<option value="bollinger">Bollinger Bands</option>
<option value="ichimoku">Ichimoku</option>
</select>
<div id="chart"></div>
<div id="rsi-pane" style="width:100%; height:150px; display:none;"></div>
<div id="tooltip"></div>
<script>
if (typeof LightweightCharts === 'undefined') {
console.error('LightweightCharts library failed to load.');
} else {
const chartElement = document.getElementById('chart');
const rsiPaneElement = document.getElementById('rsi-pane');
const timeframeSelect = document.getElementById('timeframe');
const indicatorSelect = document.getElementById('indicator');
let chart, candleSeries, volumeSeries, rsiChart, rsiSeries;
function createChart() {
if (chart) chart.remove();
chart = LightweightCharts.createChart(chartElement, {
width: window.innerWidth * 0.9,
height: 500,
layout: { backgroundColor: '#ffffff', textColor: '#000' },
grid: { vertLines: { color: '#eee' }, horzLines: { color: '#eee' } },
timeScale: { timeVisible: true, borderColor: '#ccc' },
});
candleSeries = chart.addCandlestickSeries();
volumeSeries = chart.addHistogramSeries({
color: '#26a69a',
priceFormat: { type: 'volume' },
priceScaleId: '',
scaleMargins: { top: 0.8, bottom: 0 },
});
}
async function fetchHistoricalData(interval) {
try {
const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=${interval}&limit=365`);
const data = await response.json();
const formattedData = data.map(candle => ({
time: candle[0] / 1000,
open: parseFloat(candle[1]),
high: parseFloat(candle[2]),
low: parseFloat(candle[3]),
close: parseFloat(candle[4])
}));
candleSeries.setData(formattedData);
const volumeData = data.map(candle => ({
time: candle[0] / 1000,
value: parseFloat(candle[5]),
color: parseFloat(candle[4]) >= parseFloat(candle[1]) ? '#26a69a' : '#ef5350'
}));
volumeSeries.setData(volumeData);
if (rsiSeries) {
calculateRSI(formattedData);
}
} catch (error) {
console.error('Error fetching historical data:', error);
}
}
function calculateRSI(data, period = 14) {
if (!data || data.length < period) return;
let gains = [], losses = [], rsiValues = [];
for (let i = 1; i < data.length; i++) {
let change = data[i].close - data[i - 1].close;
gains.push(change > 0 ? change : 0);
losses.push(change < 0 ? Math.abs(change) : 0);
}
let avgGain = gains.slice(0, period).reduce((a, b) => a + b, 0) / period;
let avgLoss = losses.slice(0, period).reduce((a, b) => a + b, 0) / period;
for (let i = period; i < gains.length; i++) {
avgGain = (avgGain * (period - 1) + gains[i]) / period;
avgLoss = (avgLoss * (period - 1) + losses[i]) / period;
let rs = avgLoss === 0 ? 100 : avgGain / avgLoss;
let rsi = 100 - (100 / (1 + rs));
rsiValues.push({ time: data[i + 1].time, value: rsi });
}
if (rsiSeries) {
rsiSeries.setData(rsiValues);
}
}
function addRSI() {
if (!rsiChart) {
rsiPaneElement.style.display = 'block';
rsiChart = LightweightCharts.createChart(rsiPaneElement, {
width: window.innerWidth * 0.9,
height: 150,
layout: { backgroundColor: '#ffffff', textColor: '#000' },
grid: { vertLines: { color: '#eee' }, horzLines: { color: '#eee' } },
timeScale: { timeVisible: true, borderColor: '#ccc' },
});
rsiSeries = rsiChart.addLineSeries({ color: 'blue' });
}
fetchHistoricalData(timeframeSelect.value);
}
function updateChart() {
const interval = timeframeSelect.value;
createChart();
fetchHistoricalData(interval);
}
indicatorSelect.addEventListener('change', () => {
if (indicatorSelect.value === 'rsi') {
addRSI();
}
});
timeframeSelect.addEventListener('change', updateChart);
updateChart();
}
</script>
</body>
</html>